import{C as e,_ as t,a as n,s as r,b as i,c as s,E as o,S as a}from"./index-dceb27bc.js";import{domain as c,IntChainIdTypedDataV4Signer as d,TypedDataVersionedSigner as u}from"./index-92ad38be.js";import"cross-fetch/polyfill";import"limiter";import"exponential-backoff";import"graphql-request";import"ethers";import"@openzeppelin/merkle-tree";const h=-32603,l=-32601,g=/Method not found/i,f=/eth_signTypedData_v4 does not exist/i,m=/eth_signTypedData_v3 does not exist/i,p=/RPC request failed/i,v=/provided chainid .* must match the active chainid/i,w={[o.EIP712]:a.EIP712,[o.ETHSIGN]:a.ETHSIGN};async function y(e){const{chainId:t,signer:n,order:i,signingScheme:s}=e,o=k(t);return r(o,i,n,w[s])}async function I(e){const{chainId:t,signer:n,signingScheme:r,orderUid:s}=e,o=k(t);return i(o,s,n,w[r])}async function S(e){const{chainId:t,signer:n,signingScheme:r,orderUids:i}=e,o=k(t);return s(o,i,n,w[r])}async function _(n,r,i,s="v4"){var a;const c="eth_sign"===s?o.ETHSIGN:o.EIP712;let w,y=null;try{switch(s){case"default":case"v3":w=new u(i);break;case"int_v4":w=new d(i);break;default:w=i}}catch(t){throw console.error("Wallet not supported:",t),new e("Wallet not supported")}try{y=await r(t({},n,{signer:w,signingScheme:c}))}catch(e){if(void 0===(I=e).code&&void 0===I.message)throw console.error(e),e;const t=[g,p].some(t=>[e.message,e.toString()].some(e=>t.test(e)));if(e.code!==l&&!t){if(v.test(e.message))return _(n,r,i,"int_v4");if(e.code===h)return _(n,r,i,"eth_sign");if(f.test(e.message))return _(n,r,i,"v3");if(m.test(e.message))return _(n,r,i,"eth_sign");throw console.error(e),e}switch(s){case"v4":return _(n,r,i,"default");case"default":return _(n,r,i,"v3");case"v3":return _(n,r,i,"eth_sign");default:throw e}}var I;const S=null==(a=y)?void 0:a.data;return{signature:(null==S?void 0:S.toString())||"",signingScheme:c}}async function b(e,t,n){return _({order:e,chainId:t},y,n)}async function E(e,t,n){return _({orderUid:e,chainId:t},I,n)}async function x(e,t,n){return _({orderUids:e,chainId:t},S,n)}function k(t){const r=n[t];if(!r)throw new e("Unsupported network. Settlement contract is not deployed");return c(t,r)}export{k as getDomain,b as signOrder,E as signOrderCancellation,x as signOrderCancellations};
//# sourceMappingURL=utils-00aa6acb.js.map
